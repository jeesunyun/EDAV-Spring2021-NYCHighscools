<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | NYC High school demographics analysis</title>
  <meta name="description" content="Chapter 3 Data transformation | NYC High school demographics analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | NYC High school demographics analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | NYC High school demographics analysis" />
  
  
  

<meta name="author" content="Brian Hernandez, Jeesun Yun, Changxing Wang" />


<meta name="date" content="2021-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/fgb.js"></script>
<script src="libs/FlatGeoBuf-3.3.3/flatgeobuf-geojson.min.js"></script>
<script src="libs/chromajs-2.1.0/chroma.min.js"></script>
<link id="locations_sf-1-attachment" rel="attachment" href="libs/locations_sf-0.0.1/locations_sf_layer.fgb"/>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYC High school</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a><ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#dataset-information"><i class="fa fa-check"></i><b>2.1</b> Dataset information</a><ul>
<li class="chapter" data-level="2.1.1" data-path="data-sources.html"><a href="data-sources.html#school-demographics-and-high-school-directory-data"><i class="fa fa-check"></i><b>2.1.1</b> School demographics and high school directory data</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-sources.html"><a href="data-sources.html#nyc-censys-and-health-data"><i class="fa fa-check"></i><b>2.1.2</b> NYC censys and health data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#problems-with-nyc-datasets-health-and-census-data."><i class="fa fa-check"></i><b>2.2</b> Problems with NYC datasets health and census data.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a><ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#data-preparation-for-high-school-directory-data-and-demographics-join"><i class="fa fa-check"></i><b>3.1</b> Data preparation for high school directory data and demographics join</a><ul>
<li class="chapter" data-level="3.1.1" data-path="data-transformation.html"><a href="data-transformation.html#demographics-data"><i class="fa fa-check"></i><b>3.1.1</b> Demographics data</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-transformation.html"><a href="data-transformation.html#high-school-directory-data"><i class="fa fa-check"></i><b>3.1.2</b> High school directory data</a></li>
<li class="chapter" data-level="3.1.3" data-path="data-transformation.html"><a href="data-transformation.html#join-data"><i class="fa fa-check"></i><b>3.1.3</b> Join data</a></li>
<li class="chapter" data-level="3.1.4" data-path="data-transformation.html"><a href="data-transformation.html#high-school-location-data"><i class="fa fa-check"></i><b>3.1.4</b> High school location data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a><ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#missing-values-by-column"><i class="fa fa-check"></i><b>4.1</b> Missing values by column</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#preparing-nycgeo-package-and-the-base-map-boundaries"><i class="fa fa-check"></i><b>5.1</b> Preparing NYCgeo package and the base map (boundaries)</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#explore-characteristics-shared-by-schools"><i class="fa fa-check"></i><b>5.2</b> Explore characteristics shared by schools</a><ul>
<li class="chapter" data-level="5.2.1" data-path="results.html"><a href="results.html#courses-and-programs"><i class="fa fa-check"></i><b>5.2.1</b> Courses and Programs</a></li>
<li class="chapter" data-level="5.2.2" data-path="results.html"><a href="results.html#demographics"><i class="fa fa-check"></i><b>5.2.2</b> Demographics</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#different-categories-of-schools-in-nyc"><i class="fa fa-check"></i><b>5.3</b> Different Categories of schools in NYC</a><ul>
<li class="chapter" data-level="5.3.1" data-path="results.html"><a href="results.html#geo-spatitial-interactive-map-of-nyc-school-datasets"><i class="fa fa-check"></i><b>5.3.1</b> Geo-spatitial Interactive Map of NYC school datasets</a></li>
<li class="chapter" data-level="5.3.2" data-path="results.html"><a href="results.html#maps-high-schools"><i class="fa fa-check"></i><b>5.3.2</b> Maps high schools</a></li>
<li class="chapter" data-level="5.3.3" data-path="results.html"><a href="results.html#graph-of-the-vocational-high-school"><i class="fa fa-check"></i><b>5.3.3</b> Graph of the vocational high school</a></li>
<li class="chapter" data-level="5.3.4" data-path="results.html"><a href="results.html#intermediate-schools"><i class="fa fa-check"></i><b>5.3.4</b> Intermediate schools</a></li>
<li class="chapter" data-level="5.3.5" data-path="results.html"><a href="results.html#student-diversity-satisfaction-vs.actual-school-diversity"><i class="fa fa-check"></i><b>5.3.5</b> Student Diversity Satisfaction vs. Actual School Diversity</a></li>
<li class="chapter" data-level="5.3.6" data-path="results.html"><a href="results.html#special-education-school-mapping"><i class="fa fa-check"></i><b>5.3.6</b> Special education school mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a><ul>
<li class="chapter" data-level="6.1" data-path="interactive-component.html"><a href="interactive-component.html#our-process"><i class="fa fa-check"></i><b>6.1</b> Our Process</a></li>
<li class="chapter" data-level="6.2" data-path="interactive-component.html"><a href="interactive-component.html#our-solution"><i class="fa fa-check"></i><b>6.2</b> Our Solution</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a><ul>
<li class="chapter" data-level="7.1" data-path="conclusion.html"><a href="conclusion.html#limitations"><i class="fa fa-check"></i><b>7.1</b> Limitations</a></li>
<li class="chapter" data-level="7.2" data-path="conclusion.html"><a href="conclusion.html#lessons-learned"><i class="fa fa-check"></i><b>7.2</b> Lessons learned</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC High school demographics analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<div id="data-preparation-for-high-school-directory-data-and-demographics-join" class="section level2">
<h2><span class="header-section-number">3.1</span> Data preparation for high school directory data and demographics join</h2>
<div id="demographics-data" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Demographics data</h3>
<p>Grades included in the demographics data:</p>
<pre><code>##  [1] &quot;Grade 3K+PK (Half Day &amp; Full Day)&quot; &quot;Grade K&quot;                          
##  [3] &quot;Grade 1&quot;                           &quot;Grade 2&quot;                          
##  [5] &quot;Grade 3&quot;                           &quot;Grade 4&quot;                          
##  [7] &quot;Grade 5&quot;                           &quot;Grade 6&quot;                          
##  [9] &quot;Grade 7&quot;                           &quot;Grade 8&quot;                          
## [11] &quot;Grade 9&quot;                           &quot;Grade 10&quot;                         
## [13] &quot;Grade 11&quot;                          &quot;Grade 12&quot;</code></pre>
<p>School years included in the demographics data, and some variables included in the demographics data:</p>
<pre><code>## # A tibble: 5 x 1
##   Year   
##   &lt;chr&gt;  
## 1 2015-16
## 2 2016-17
## 3 2017-18
## 4 2018-19
## 5 2019-20</code></pre>
<pre><code>##  [1] &quot;% Female&quot;                                  
##  [2] &quot;% Male&quot;                                    
##  [3] &quot;% Asian&quot;                                   
##  [4] &quot;% Black&quot;                                   
##  [5] &quot;% Hispanic&quot;                                
##  [6] &quot;% Multiple Race Categories Not Represented&quot;
##  [7] &quot;% White&quot;                                   
##  [8] &quot;% Students with Disabilities&quot;              
##  [9] &quot;% English Language Learners&quot;               
## [10] &quot;% Poverty&quot;</code></pre>
<pre><code>## [1] &quot;DBN&quot;                               &quot;School Name&quot;                      
## [3] &quot;Year&quot;                              &quot;Total Enrollment&quot;                 
## [5] &quot;Grade 3K+PK (Half Day &amp; Full Day)&quot; &quot;Grade K&quot;</code></pre>
<p>We can see that the data contains data not only for high school, and for school years other than 2019.</p>
<p>The column names are difficult to retract due to spaces and special characters, so we rename columns that is easier to retract.</p>
<ul>
<li>replace “%” to “pct” and spaces to &quot;_&quot;</li>
</ul>
<pre><code>##  [1] &quot;pct_Female&quot;                                  
##  [2] &quot;pct_Male&quot;                                    
##  [3] &quot;pct_Asian&quot;                                   
##  [4] &quot;pct_Black&quot;                                   
##  [5] &quot;pct_Hispanic&quot;                                
##  [6] &quot;pct_Multiple_Race_Categories_Not_Represented&quot;
##  [7] &quot;pct_White&quot;                                   
##  [8] &quot;pct_Students_with_Disabilities&quot;              
##  [9] &quot;pct_English_Language_Learners&quot;               
## [10] &quot;pct_Poverty&quot;</code></pre>
<pre><code>## [1] &quot;DBN&quot;                               &quot;School_Name&quot;                      
## [3] &quot;Year&quot;                              &quot;Total_Enrollment&quot;                 
## [5] &quot;Grade_3K+PK_(Half_Day_&amp;_Full_Day)&quot; &quot;Grade_K&quot;</code></pre>
<p>We don’t want schools that are not high schools; the grade range is different per school, so we filter out schools that do not have grades 10, 11, and 12.
Then, create new columns that contain population counts for high school grades and non-highschool grades.</p>
<p>Here, we set for high school to be from grades 9 to 12, according to <a href="https://www.schools.nyc.gov/enrollment/enroll-grade-by-grade/high-school">New York city Department of Education description</a>. It is given that students in their 8th grade apply to high schools. We assume that schools that have grades 6 to 12, or K to 12, etc. have continuing students.</p>
<p>Also, the dataset consists of information ranging from school years 2015 to 2019. We want to filter out years other than 2019 for initial processing of the data since the directory data are for 2019-2020.</p>
<p>Moreover, we created new columns <code>hs_enroll</code> and <code>non_hs</code> to divide population that are in grades 9 to 12 to others.</p>
<pre><code>## # A tibble: 6 x 5
##   DBN    School_Name                           Year   Total_Enrollment hs_enroll
##   &lt;chr&gt;  &lt;chr&gt;                                 &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;
## 1 01M292 Orchard Collegiate Academy            2019-…              226       226
## 2 01M448 University Neighborhood High School   2019-…              492       492
## 3 01M450 East Side Community School            2019-…              680       364
## 4 01M458 Forsyth Satellite Academy             2019-…              181       181
## 5 01M509 Marta Valle High School               2019-…               97        97
## 6 01M515 Lower East Side Preparatory High Sch… 2019-…              531       531</code></pre>
</div>
<div id="high-school-directory-data" class="section level3">
<h3><span class="header-section-number">3.1.2</span> High school directory data</h3>
<p>Dimension of the directory data:</p>
<pre><code>## [1] 427 462</code></pre>
<p>The directory data has very extensive information each schools, from basic school information to detailed descriptions of each program and admission information.
However, we do not want more than 400 variables, so we select only the information relevant and informative to us.
Such variables are: basic school information(DBN, school name, neighborhood) to characteristic information(programs, statistics, admissions).</p>
<p>The directory data has very extensive information each schools, from basic school information to detailed descriptions of each program and admission information.
However, we do not want more than 400 variables, so we select only the information relevant and informative to us.
Such variables are: basic school information(DBN, school name, neighborhood) to characteristic information(programs, statistics, admissions).</p>
<pre><code>## # A tibble: 6 x 5
##   dbn    school_name                     Borough neighborhood     total_students
##   &lt;chr&gt;  &lt;chr&gt;                           &lt;chr&gt;   &lt;chr&gt;                     &lt;dbl&gt;
## 1 16K498 Brooklyn High School for Law a… BROOKL… Bedford-Stuyves…            594
## 2 17K524 International High School at P… BROOKL… Crown Heights S…            417
## 3 02M531 Repertory Company High School … MANHAT… Midtown                     242
## 4 05M670 Thurgood Marshall Academy for … MANHAT… Central Harlem …            547
## 5 15K423 Brooklyn Frontiers High School  BROOKL… DUMBO-Downtown …            168
## 6 03M291 West End Secondary School       MANHAT… Lincoln Square              339</code></pre>
</div>
<div id="join-data" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Join data</h3>
<p>Since we have the names and the DBN which are unique, we join the two datasets using these columns as indicators.</p>
<pre><code>##                                                             dbn
## Brooklyn High School for Law and Technology              16K498
## International High School at Prospect Heights            17K524
## Repertory Company High School for Theatre Arts           02M531
## Thurgood Marshall Academy for Learning and Social Change 05M670
## Brooklyn Frontiers High School                           15K423
## West End Secondary School                                03M291
##                                                                     neighborhood
## Brooklyn High School for Law and Technology                   Bedford-Stuyvesant
## International High School at Prospect Heights                Crown Heights South
## Repertory Company High School for Theatre Arts                           Midtown
## Thurgood Marshall Academy for Learning and Social Change    Central Harlem North
## Brooklyn Frontiers High School                           DUMBO-Downtown Brooklyn
## West End Secondary School                                         Lincoln Square
##                                                          total_students
## Brooklyn High School for Law and Technology                         594
## International High School at Prospect Heights                       417
## Repertory Company High School for Theatre Arts                      242
## Thurgood Marshall Academy for Learning and Social Change            547
## Brooklyn Frontiers High School                                      168
## West End Secondary School                                           339
##                                                          Total_Enrollment
## Brooklyn High School for Law and Technology                           578
## International High School at Prospect Heights                         370
## Repertory Company High School for Theatre Arts                        237
## Thurgood Marshall Academy for Learning and Social Change              541
## Brooklyn Frontiers High School                                        186
## West End Secondary School                                              NA
##                                                          hs_enroll
## Brooklyn High School for Law and Technology                    578
## International High School at Prospect Heights                  370
## Repertory Company High School for Theatre Arts                 237
## Thurgood Marshall Academy for Learning and Social Change       374
## Brooklyn Frontiers High School                                 186
## West End Secondary School                                       NA</code></pre>
<p>It is interesting that the total number of students are not equal in both data sets.</p>
<p>Number of observations with different reported population:</p>
<pre><code>## [1] 420  66</code></pre>
<p>Number of observations with identical reported population:</p>
<pre><code>## [1]  5 66</code></pre>
<p>Only 5 schools have total number of students identical in both data sets.</p>
<p>Investigating the data, we see that there are population data missing for 2 schools from the <code>Demographics</code> dataset.
Column <code>Total_Enrollment</code> comes from Demographics data, and <code>total_students</code> come from Directory data.</p>
<p>Schools that are in the Directory data but not in the demographics data:</p>
<pre><code>##                                                  total_students
## West End Secondary School                                   339
## The Eagle Academy for Young Men of Staten Island            253
##                                                  Total_Enrollment
## West End Secondary School                                      NA
## The Eagle Academy for Young Men of Staten Island               NA</code></pre>
<pre><code>##                                                  grades2018
## West End Secondary School                           6 to 10
## The Eagle Academy for Young Men of Staten Island    6 to 11
##                                                                                                  finalgrades
## West End Secondary School                        6 to 10 - This school is expanding to serve grades 6 to 12.
## The Eagle Academy for Young Men of Staten Island 6 to 11 - This school is expanding to serve grades 6 to 12.</code></pre>
<p>We can see that these two schools share that they do not serve grades until 12th grade.
According to the aforementioned NYC high school description (grade 9 to 12), we can filter out these schools.
Also, since the demographic data are from the Demographics dataset, we recalculate the other values into proportion with the demographics total population.</p>
<p>Take out the <code>total_students</code> column and the <code>School_Name</code> column, since two dataframes were joined by <code>dbn</code> and the school names are written differently.</p>
<p>Add quartile of graduation rate to get a sense of how schools are performing</p>
<p>Save final dataframe to a csv for use with D3</p>
</div>
<div id="high-school-location-data" class="section level3">
<h3><span class="header-section-number">3.1.4</span> High school location data</h3>
<pre><code>## # A tibble: 6 x 10
##   dbn   school_name total_students Borough city    zip Latitude Longitude
##   &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 16K4… Brooklyn H…            594 BROOKL… Broo… 11221     40.7     -73.9
## 2 17K5… Internatio…            417 BROOKL… Broo… 11225     40.7     -74.0
## 3 02M5… Repertory …            242 MANHAT… Manh… 10036     40.8     -74.0
## 4 05M6… Thurgood M…            547 MANHAT… Manh… 10030     40.8     -73.9
## 5 15K4… Brooklyn F…            168 BROOKL… Broo… 11201     40.7     -74.0
## 6 03M2… West End S…            339 MANHAT… Manh… 10023     40.8     -74.0
## # … with 2 more variables: `Census Tract` &lt;dbl&gt;, NTA &lt;chr&gt;</code></pre>
<p>This dataframe contains only the information on the location extracted from the high school directory file.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jeesunyun/nyc-hs/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jeesunyun/nyc-hs/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
